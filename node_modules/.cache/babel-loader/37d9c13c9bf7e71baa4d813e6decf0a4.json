{"ast":null,"code":"var _jsxFileName = \"/home/bundi/projects/fiver/Tic-Tac-Toe-React-Flask-Sock/src/components/pages/Start.js\";\nimport React, { useEffect, useState } from 'react';\nimport Choice from '../functional/Choice.js';\nimport InputForm from '../functional/InputForm.js';\nimport Loading from '../functional/Loading';\nimport Error from '../functional/Error';\nimport logo from './logo.png';\nimport { Redirect } from 'react-router-dom';\nimport socketIOClient from 'socket.io-client';\nconst ENDPOINT = 'http://127.0.0.1:8081';\nconst socket = socketIOClient(ENDPOINT);\nexport default function Start(props) {\n  const [step, setStep] = useState(1);\n  const [name, setName] = useState('');\n  const [errorMessage, setErrorMessage] = useState('');\n  const [newGame, setNewGame] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [serverConfirmed, setServerConfirmed] = useState(false);\n  const [error, setError] = useState(false);\n  var choice = '';\n  useEffect(() => {\n    console.log('useEffect');\n    socket.on('newGameCreated', () => {\n      console.log('newGameCreated');\n      setServerConfirmed(true);\n    });\n    socket.on('joinConfirmed', () => {\n      setServerConfirmed(true);\n    });\n    socket.on('errorMessage', message => displayError(message));\n    socket.on('gameStatus', (gameStatus, joinStatus) => {\n      console.log(gameStatus);\n      handlerChoice(gameStatus, joinStatus);\n    });\n    socket.on('visitConfirmed', () => {\n      setServerConfirmed(true);\n    });\n  });\n\n  const onChoice = choiceParam => {\n    choice = choiceParam;\n    socket.emit('getGameStatus');\n  };\n\n  const handlerChoice = (gameStatus, joinStatus) => {\n    if (gameStatus && choice === 'new') {\n      // game started, new\n      displayError('The game has already created.');\n    } else if (choice == 'leaderboard') {} else if (choice !== 'new' && !gameStatus) {\n      // game not started, join\n      console.log(choice);\n      displayError('The game was not started yet');\n    } else if (choice === 'join' && joinStatus) {\n      displayError('The game has already started.');\n    } else if (choice === 'visit' && !joinStatus) {\n      displayError('There is only one player.');\n    } else {\n      console.log('LEADERBOARD'); // newGame = choice\n\n      setNewGame(choice);\n      stepForward();\n    }\n  };\n\n  const validate = () => {\n    return !(name === '');\n  };\n\n  const onSubmit = () => {\n    console.log('onSubmit');\n    console.log(name);\n    setLoading(true);\n\n    if (validate()) {\n      if (newGame === 'new') {\n        console.log('newGame');\n        socket.emit('newGame', name);\n      } else if (newGame === 'join') {\n        socket.emit('joining', name);\n      } else if (newGame === 'visit') {\n        socket.emit('visiting', name);\n      } else if (newGame === 'leaderboard') {\n        console.log(\"LEEADEDAERF\");\n        socket.emit('leaderboard', name);\n      }\n    } else {\n      setTimeout(() => setLoading(false), 500);\n      displayError('Please fill out your name');\n    }\n  };\n\n  const stepBack = () => {\n    setStep(step - 1);\n  };\n\n  const stepForward = () => {\n    setStep(step + 1);\n  };\n\n  const onTyping = e => {\n    setName(e.target.value);\n  };\n\n  const displayError = message => {\n    setError(true);\n    setErrorMessage(message);\n    setLoading(false);\n    setTimeout(() => {\n      setError(false);\n      setErrorMessage('');\n    }, 3000);\n  };\n\n  if (serverConfirmed) {\n    return /*#__PURE__*/React.createElement(Redirect, {\n      to: `/game?permission=${newGame}&name=${name}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }\n    });\n  } else {\n    switch (step) {\n      case 1:\n        return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Choice, {\n          logo: logo,\n          onChoice: onChoice,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 15\n          }\n        }), /*#__PURE__*/React.createElement(Error, {\n          display: error,\n          message: errorMessage,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 15\n          }\n        }));\n\n      case 2:\n        return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Loading, {\n          loading: loading,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 15\n          }\n        }), /*#__PURE__*/React.createElement(Error, {\n          display: error,\n          message: errorMessage,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 15\n          }\n        }), /*#__PURE__*/React.createElement(InputForm, {\n          stepBack: stepBack,\n          onSubmit: onSubmit,\n          onTyping: onTyping.bind(this),\n          newGame: newGame,\n          name: name,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 15\n          }\n        }));\n\n      default:\n        return null;\n    }\n  }\n}","map":{"version":3,"sources":["/home/bundi/projects/fiver/Tic-Tac-Toe-React-Flask-Sock/src/components/pages/Start.js"],"names":["React","useEffect","useState","Choice","InputForm","Loading","Error","logo","Redirect","socketIOClient","ENDPOINT","socket","Start","props","step","setStep","name","setName","errorMessage","setErrorMessage","newGame","setNewGame","loading","setLoading","serverConfirmed","setServerConfirmed","error","setError","choice","console","log","on","message","displayError","gameStatus","joinStatus","handlerChoice","onChoice","choiceParam","emit","stepForward","validate","onSubmit","setTimeout","stepBack","onTyping","e","target","value","bind"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\n\r\nimport Choice from '../functional/Choice.js'\r\nimport InputForm from '../functional/InputForm.js'\r\nimport Loading from '../functional/Loading'\r\nimport Error from '../functional/Error'\r\nimport logo from './logo.png'\r\n\r\nimport { Redirect } from 'react-router-dom'\r\n\r\nimport socketIOClient from 'socket.io-client'\r\n\r\nconst ENDPOINT = 'http://127.0.0.1:8081'\r\nconst socket = socketIOClient(ENDPOINT)\r\n\r\nexport default function Start(props) {\r\n  const [step, setStep] = useState(1)\r\n  const [name, setName] = useState('')\r\n  const [errorMessage, setErrorMessage] = useState('')\r\n  const [newGame, setNewGame] = useState(null)\r\n  const [loading, setLoading] = useState(false)\r\n  const [serverConfirmed, setServerConfirmed] = useState(false)\r\n  const [error, setError] = useState(false)\r\n  var choice = ''\r\n\r\n  useEffect(() => {\r\n    console.log('useEffect')\r\n    socket.on('newGameCreated', () => {\r\n      console.log('newGameCreated')\r\n      setServerConfirmed(true)\r\n    })\r\n    socket.on('joinConfirmed', () => {\r\n      setServerConfirmed(true)\r\n    })\r\n    socket.on('errorMessage', (message) => displayError(message))\r\n    socket.on('gameStatus', (gameStatus, joinStatus) => {\r\n      console.log(gameStatus);  \r\n      handlerChoice(gameStatus, joinStatus);\r\n    })\r\n    socket.on('visitConfirmed', () => {\r\n      setServerConfirmed(true)\r\n    })\r\n  })\r\n\r\n  const onChoice = (choiceParam) => {\r\n    choice = choiceParam\r\n    socket.emit('getGameStatus')\r\n  }\r\n\r\n  const handlerChoice = (gameStatus, joinStatus) => {\r\n    if (gameStatus && choice === 'new') { // game started, new\r\n      displayError('The game has already created.')\r\n\r\n    } else if(choice == 'leaderboard'){\r\n\r\n\r\n    }else if(choice !== 'new' && !gameStatus) { // game not started, join\r\n      console.log(choice);\r\n      displayError('The game was not started yet')\r\n    } else if(choice === 'join' && joinStatus) {\r\n      displayError('The game has already started.')\r\n    }\r\n    else if(choice === 'visit' && !joinStatus) {\r\n      displayError('There is only one player.')\r\n    } else {\r\n      console.log('LEADERBOARD');\r\n      // newGame = choice\r\n      setNewGame(choice)\r\n      stepForward()\r\n    }\r\n  }\r\n\r\n  const validate = () => {\r\n    return !(name === '')\r\n  }\r\n\r\n  const onSubmit = () => {\r\n    console.log('onSubmit')\r\n    console.log(name)\r\n    setLoading(true)\r\n    if (validate()) {\r\n      if (newGame === 'new') {\r\n        console.log('newGame')\r\n        socket.emit('newGame', name)\r\n      } else if(newGame === 'join') {\r\n        socket.emit('joining', name)\r\n      } else if (newGame === 'visit') {\r\n        socket.emit('visiting', name)\r\n      } else if (newGame === 'leaderboard') {\r\n        console.log(\"LEEADEDAERF\");\r\n        socket.emit('leaderboard', name)\r\n      }\r\n    } else {\r\n      setTimeout(() => setLoading(false), 500)\r\n      displayError('Please fill out your name')\r\n    }\r\n  }\r\n\r\n  const stepBack = () => {\r\n    setStep(step - 1)\r\n  }\r\n\r\n  const stepForward = () => {\r\n    setStep(step + 1)\r\n  }\r\n\r\n  const onTyping = (e) => {\r\n    setName(e.target.value)\r\n  }\r\n\r\n  const displayError = (message) => {\r\n    setError(true)\r\n    setErrorMessage(message)\r\n    setLoading(false)\r\n\r\n    setTimeout(() => {\r\n      setError(false)\r\n      setErrorMessage('')\r\n    }, 3000)\r\n  }\r\n\r\n    if (serverConfirmed) {\r\n      return (\r\n        <Redirect to={`/game?permission=${newGame}&name=${name}`}/>\r\n      )\r\n    } else {\r\n      switch (step) {\r\n        case(1):\r\n          return (\r\n            <>\r\n              <Choice logo={logo} onChoice={onChoice}/>\r\n              <Error display={error} message={errorMessage}/>\r\n            </>\r\n          );\r\n        case(2):\r\n          return (\r\n            <>\r\n              <Loading loading={loading}/>\r\n              <Error display={error} message={errorMessage}/>\r\n              <InputForm\r\n                stepBack={stepBack}\r\n                onSubmit={onSubmit}\r\n                onTyping={onTyping.bind(this)}\r\n                newGame={newGame}\r\n                name={name}\r\n              />\r\n            </>\r\n          );\r\n        default:\r\n          return null\r\n      }\r\n    }\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}